(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23477,        574]
NotebookOptionsPosition[     20728,        520]
NotebookOutlinePosition[     21141,        536]
CellTagsIndexPosition[     21098,        533]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", "2.", ",", "3.", ",", "4.", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3.", ",", "4.", ",", "1.", ",", "2.", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7.", ",", "8.", ",", "9.", ",", "1.", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4.", ",", "3.", ",", "2.", ",", "1.", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11.", ",", "21.", ",", "31.", ",", "41.", ",", "1"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"31.", ",", "41.", ",", "11.", ",", "21.", ",", "1"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"71.", ",", "81.", ",", "91.", ",", "13.", ",", "1"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"41.", ",", "31.", ",", "21.", ",", "12.", ",", "1"}], "}"}]}],
      "}"}]}], ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.9071414553062925`*^9, 3.9071414599565296`*^9}, {
   3.9071627997477465`*^9, 3.907162844704317*^9}, {3.907243081747366*^9, 
   3.9072431050344887`*^9}, {3.907249867965254*^9, 3.9072498779564295`*^9}, {
   3.9072519300445633`*^9, 3.907251949341741*^9}, 3.9072523470890474`*^9},
 CellLabel->
  "In[654]:=",ExpressionUUID->"b051db69-d9b6-44f7-9c3e-d1fdd77e9b4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.907141477372984*^9, 3.907141483377489*^9}},
 CellLabel->
  "In[655]:=",ExpressionUUID->"92a7cb09-91af-4e91-b907-add0498edda2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "2.`", "3.`", "4.`", "1"},
     {"3.`", "4.`", "1.`", "2.`", "1"},
     {"7.`", "8.`", "9.`", "1.`", "1"},
     {"4.`", "3.`", "2.`", "1.`", "1"},
     {"11.`", "21.`", "31.`", "41.`", "1"},
     {"31.`", "41.`", "11.`", "21.`", "1"},
     {"71.`", "81.`", "91.`", "13.`", "1"},
     {"41.`", "31.`", "21.`", "12.`", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9072519784118395`*^9, 3.907252018119217*^9, 3.907252112148909*^9, {
   3.9072521677625866`*^9, 3.9072521787350883`*^9}, 3.907252656672392*^9, 
   3.9072527556606865`*^9, 3.9072529272093177`*^9, 3.9072530504573584`*^9, 
   3.9072531723839474`*^9, 3.907253254486862*^9, 3.907253844556714*^9, 
   3.9072538900953627`*^9, 3.9072540165872765`*^9, 3.907254054376149*^9, 
   3.9072549313666444`*^9, 3.9072551736021533`*^9, 3.907257262421095*^9},
 CellLabel->
  "Out[655]//MatrixForm=",ExpressionUUID->"ef5c77d6-6450-4649-b713-\
22e514c4749d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11.", ",", "12."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"21.", ",", "22."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"31.", ",", "32."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"41.", ",", "42."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"51.", ",", "12."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"61.", ",", "22."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"81.", ",", "32."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"91.", ",", "42."}], "}"}]}], "}"}]}], ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.907141585344768*^9, 3.9071416002148886`*^9}, {
   3.907162851407012*^9, 3.907162868770544*^9}, {3.907252054441554*^9, 
   3.9072520821434793`*^9}, 3.9072523571346235`*^9},
 CellLabel->
  "In[656]:=",ExpressionUUID->"d0d15832-23d8-4473-8e00-3bc3cc3b008d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Y", " ", "=", " ", 
   RowBox[{"Transpose", "[", "Y", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9071416080609694`*^9, 3.9071416172456656`*^9}},
 CellLabel->
  "In[657]:=",ExpressionUUID->"d50c79a1-a410-43d9-8f87-73320be13141"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Y", "]"}]], "Input",
 CellChangeTimes->{{3.9071416215041304`*^9, 3.9071416301574593`*^9}},
 CellLabel->
  "In[658]:=",ExpressionUUID->"cfbe2cca-813e-44d6-851f-fe0b27d64e71"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"11.`", "21.`", "31.`", "41.`", "51.`", "61.`", "81.`", "91.`"},
     {"12.`", "22.`", "32.`", "42.`", "12.`", "22.`", "32.`", "42.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9071416319604*^9, {3.9071590021988235`*^9, 3.907159024928062*^9}, 
   3.907162917818392*^9, 3.907171616619478*^9, 3.9071717322169523`*^9, 
   3.9071718381567297`*^9, 3.907243129550092*^9, 3.907250060954488*^9, 
   3.9072502698250704`*^9, {3.907250388133363*^9, 3.9072504087870064`*^9}, 
   3.907250466088396*^9, 3.9072506597989254`*^9, 3.9072507691875715`*^9, 
   3.9072508138544164`*^9, 3.9072508862667947`*^9, {3.907251004972972*^9, 
   3.9072510394341774`*^9}, 3.907251135887558*^9, 3.9072512694300823`*^9, 
   3.9072516291567955`*^9, 3.9072516624419603`*^9, 3.907251738951519*^9, 
   3.9072517830993443`*^9, 3.9072519784428115`*^9, 3.907252018148193*^9, 
   3.907252112176893*^9, {3.9072521677885714`*^9, 3.907252178770119*^9}, 
   3.907252656700376*^9, 3.9072527556886806`*^9, 3.9072529272752795`*^9, 
   3.907253050484334*^9, 3.907253172410921*^9, 3.9072532545128365`*^9, 
   3.9072538445847087`*^9, 3.907253890121348*^9, 3.907254016616331*^9, 
   3.907254054404133*^9, 3.9072549314325895`*^9, 3.9072551736161456`*^9, 
   3.907257262454076*^9},
 CellLabel->
  "Out[658]//MatrixForm=",ExpressionUUID->"38e6bc96-5357-4bac-95d1-\
acdee66370ad"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "X", "]"}], ".", "X"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9071417700894055`*^9, 3.9071417885482435`*^9}, {
  3.907142005427084*^9, 3.9071420094680386`*^9}, {3.907142053381158*^9, 
  3.9071420562793226`*^9}, {3.9071587743631973`*^9, 3.9071587797402525`*^9}, {
  3.9071588440877547`*^9, 3.907158898695078*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"55bdb737-2fa2-4e4f-b986-c35ca0836a04"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Z", "]"}]], "Input",
 CellChangeTimes->{3.9072504468086557`*^9},
 CellLabel->
  "In[660]:=",ExpressionUUID->"9fe16466-afb8-4fab-95d1-fe0acc0a9d4c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"7879.`", "8606.`", "8081.`", "2538.`", "169.`"},
     {"8606.`", "9737.`", "9212.`", "3174.`", "191.`"},
     {"8081.`", "9212.`", "9899.`", "2962.`", "169.`"},
     {"2538.`", "3174.`", "2962.`", "2457.`", "95.`"},
     {"169.`", "191.`", "169.`", "95.`", "8.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9072532545238295`*^9, 3.907253844597701*^9, 
  3.907253890133341*^9, 3.9072540166283402`*^9, 3.907254054417136*^9, 
  3.9072549314677052`*^9, 3.9072551736301274`*^9, 3.907257262487048*^9},
 CellLabel->
  "Out[660]//MatrixForm=",ExpressionUUID->"914d0048-91b0-46d5-8260-\
c6a80f04a249"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"K", " ", "=", " ", 
   RowBox[{"Y", ".", "X"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}]}], "Input",
 CellChangeTimes->{{3.907158927371023*^9, 3.907158937251814*^9}, {
   3.9072489799703865`*^9, 3.9072490536662903`*^9}, {3.907249085915598*^9, 
   3.9072492405405054`*^9}, {3.907249667607122*^9, 3.9072496802873726`*^9}, {
   3.907249711420782*^9, 3.9072497427995167`*^9}, {3.9072497740239534`*^9, 
   3.9072499683300314`*^9}, {3.907250001241168*^9, 3.9072500043647933`*^9}, {
   3.907250194936846*^9, 3.9072502179186487`*^9}, 3.9072502566827803`*^9, {
   3.9072504441548414`*^9, 3.9072504528988085`*^9}, {3.9072506368930492`*^9, 
   3.907250639365893*^9}},
 CellLabel->
  "In[661]:=",ExpressionUUID->"df6c85d5-e358-4567-8d64-53cd2cc7491f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"12389.`", "13431.`", "11949.`", "5675.`", "388.`"},
     {"5278.`", "5542.`", "4838.`", "2040.`", "216.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.907250276750007*^9, {3.907250388151342*^9, 3.9072504088060837`*^9}, 
   3.907250466118368*^9, 3.907250659845088*^9, 3.9072507692148623`*^9, 
   3.9072508138843994`*^9, 3.9072508862967668`*^9, {3.907251005001955*^9, 
   3.9072510394721537`*^9}, 3.907251135910551*^9, 3.9072512694610643`*^9, 
   3.9072516291847787`*^9, 3.907251662468951*^9, 3.9072517389785147`*^9, 
   3.9072517831293163`*^9, 3.9072520181721845`*^9, 3.9072521121998796`*^9, {
   3.907252167811558*^9, 3.9072521787961025`*^9}, 3.9072526567273617`*^9, 
   3.907252755710702*^9, 3.907252927349386*^9, 3.90725305050932*^9, 
   3.907253172434918*^9, 3.907253254545829*^9, 3.907253844621688*^9, 
   3.9072538901563168`*^9, 3.9072540166513124`*^9, 3.907254054441112*^9, 
   3.9072549315317235`*^9, 3.907255173641123*^9, 3.9072572625150433`*^9},
 CellLabel->
  "Out[662]//MatrixForm=",ExpressionUUID->"24936c82-aa40-4703-aa5f-\
af4238623df9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B0", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", "1.", ",", "1.", ",", "1.", ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "1.", ",", "1.", ",", "1.", ",", "1."}], "}"}]}], 
     "}"}], "*", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"Y", ",", "\"\<Frobenius\>\""}], "]"}], "/", 
     RowBox[{"Norm", "[", 
      RowBox[{"X", ",", "\"\<Frobenius\>\""}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"B1", " ", "=", " ", 
   RowBox[{"B0", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"B0", ".", "Z"}], ")"}], " ", "-", " ", "K"}], ")"}], "/", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"X", ",", "\"\<Frobenius\>\""}], "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B1", "]"}]}], "Input",
 CellChangeTimes->{{3.9072503007401905`*^9, 3.9072503348075504`*^9}, 
   3.9072503943939724`*^9, {3.9072507478121185`*^9, 3.90725075019156*^9}, {
   3.9072507897888536`*^9, 3.9072508312631564`*^9}, {3.907250870794362*^9, 
   3.907250880040058*^9}, {3.9072509602948675`*^9, 3.9072509780711784`*^9}, {
   3.9072517127304296`*^9, 3.9072517740888386`*^9}, {3.907251805637744*^9, 
   3.9072518162601614`*^9}, {3.9072523885133066`*^9, 
   3.9072525541131744`*^9}, {3.9072526271648054`*^9, 3.9072526311459336`*^9}, 
   3.907252922061005*^9, 3.90725304522863*^9, {3.907253135486685*^9, 
   3.907253139334587*^9}, {3.9072532349964495`*^9, 3.9072532443018036`*^9}, {
   3.9072537462702456`*^9, 3.9072537806514378`*^9}, {3.907253873380933*^9, 
   3.9072538789066434`*^9}, {3.9072540073138604`*^9, 3.9072540454352584`*^9}, 
   3.90725458495022*^9, {3.9072548885567503`*^9, 3.9072548898733425`*^9}, {
   3.90725502179113*^9, 3.907255064929095*^9}, {3.907257224068754*^9, 
   3.907257231520692*^9}},
 CellLabel->
  "In[663]:=",ExpressionUUID->"94a86a9e-094d-41ac-9491-bf62517d2d32"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5053545639783626`", "0.4160128296541121`", "0.38689428303725126`", 
      "0.8274443200484761`", "1.0115805980521526`"},
     {"0.26816310300437995`", "0.15287073492429215`", "0.14970282206326857`", 
      "0.7061968217162546`", "1.005843439946749`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9072507692278433`*^9, 3.907250813895384*^9, 3.907250886308771*^9, {
   3.9072510050129642`*^9, 3.9072510394871464`*^9}, 3.907251135921546*^9, 
   3.9072512694730463`*^9, 3.9072516291987705`*^9, 3.9072516624819365`*^9, 
   3.907251738990507*^9, 3.90725178314132*^9, 3.9072520181831636`*^9, 
   3.9072521122088747`*^9, {3.9072521678215637`*^9, 3.907252178805096*^9}, {
   3.907252650372141*^9, 3.907252656738355*^9}, 3.907252755721696*^9, 
   3.9072529273823833`*^9, 3.9072530505183144`*^9, 3.9072531724469004`*^9, 
   3.9072532545548306`*^9, 3.907253844638668*^9, 3.9072538901673217`*^9, 
   3.9072540166643047`*^9, {3.9072540510729027`*^9, 3.9072540544551144`*^9}, 
   3.9072549315637045`*^9, 3.907255173650118*^9, 3.907257262546029*^9},
 CellLabel->
  "Out[665]//MatrixForm=",ExpressionUUID->"a2e46148-e246-45bf-b11b-\
c751369eed51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"B1", " ", "-", "B0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "L", "]"}]}], "Input",
 CellChangeTimes->{{3.9072509907029934`*^9, 3.9072510319909167`*^9}},
 CellLabel->
  "In[666]:=",ExpressionUUID->"f8990e76-1cfb-4747-8a20-084dc025ecde"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.5147894434362325`"}], 
      RowBox[{"-", "0.604131177760483`"}], 
      RowBox[{"-", "0.6332497243773438`"}], 
      RowBox[{"-", "0.19269968736611898`"}], 
      RowBox[{"-", "0.008563409362442487`"}]},
     {
      RowBox[{"-", "0.7519809044102151`"}], 
      RowBox[{"-", "0.867273272490303`"}], 
      RowBox[{"-", "0.8704411853513265`"}], 
      RowBox[{"-", "0.31394718569834046`"}], 
      RowBox[{"-", "0.014300567467846026`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9072510395001388`*^9, 3.9072511359325347`*^9, 3.9072512694830947`*^9, 
   3.907251629208764*^9, 3.9072516624919386`*^9, 3.90725173900266*^9, 
   3.907251783152305*^9, 3.9072520181931667`*^9, 3.907252112219868*^9, {
   3.907252167834545*^9, 3.907252178818081*^9}, 3.907252656749339*^9, 
   3.9072527557336893`*^9, 3.9072529274123693`*^9, 3.907253050530308*^9, 
   3.90725317246091*^9, 3.9072532545678177`*^9, 3.9072538446526594`*^9, 
   3.9072538901823025`*^9, 3.907254016678297*^9, 3.907254054470103*^9, 
   3.907254931598756*^9, 3.90725517366212*^9, 3.9072572625749955`*^9},
 CellLabel->
  "Out[667]//MatrixForm=",ExpressionUUID->"48352ea1-1349-4b49-8d8f-\
550018eda5cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"L", ",", "\"\<Frobenius\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.907251083707369*^9, 3.907251084868498*^9}, {
  3.9072572528768177`*^9, 3.907257253121869*^9}},
 CellLabel->
  "In[668]:=",ExpressionUUID->"b0f047a3-7226-4eb2-b267-a147d36eb107"],

Cell[BoxData["1.8006298271709882`"], "Output",
 CellChangeTimes->{
  3.90725162921877*^9, 3.907251662501932*^9, 3.9072517390116463`*^9, 
   3.9072517831623*^9, 3.907252018201169*^9, 3.907252112230917*^9, {
   3.907252167846538*^9, 3.9072521788280735`*^9}, 3.907252656762332*^9, 
   3.9072527557477226`*^9, 3.9072529274413424`*^9, 3.907253050539303*^9, 
   3.907253172469887*^9, 3.907253254576812*^9, 3.9072538446687727`*^9, 
   3.907253890195297*^9, 3.9072540166922874`*^9, 3.9072540544840984`*^9, 
   3.907254931629811*^9, 3.907255173674102*^9, 3.9072572625850077`*^9},
 CellLabel->
  "Out[668]=",ExpressionUUID->"656cebdd-55dc-4384-bd92-057b47f02525"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"coefi", "=", " ", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"Inner", "[", 
      RowBox[{"Times", ",", 
       RowBox[{"Flatten", "[", "L", "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"L", ".", "Z"}], "]"}], ",", "Plus"}], "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"L", ".", "Z"}], ",", "\"\<Frobenius\>\""}], "]"}], "^", 
      "2"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9072503693121595`*^9, 3.907250371323911*^9}, {
   3.9072510965396566`*^9, 3.907251097122423*^9}, 3.907252097773003*^9, 
   3.907252150557461*^9, {3.907252691992689*^9, 3.907252692315216*^9}, {
   3.907252730902464*^9, 3.907252737719658*^9}, {3.9072572381360245`*^9, 
   3.9072572383826313`*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"eca50271-2960-4610-8dbc-37773b4d2b28"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B2", " ", "=", " ", 
   RowBox[{"B1", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"B1", ".", "Z"}], "-", "K"}], ")"}], "*", "coefi"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B2", "]"}]}], "Input",
 CellChangeTimes->{{3.907250326499613*^9, 3.907250367174301*^9}, 
   3.9072521729850955`*^9},
 CellLabel->
  "In[670]:=",ExpressionUUID->"96c8fed6-9609-46f5-bf3d-218451b7da99"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.48462477846816154`", "0.36686346434571376`", "0.29898893109528013`", 
      "0.8200621742620378`", "1.0141628018413653`"},
     {"0.22009901556495579`", "0.07775191788954709`", "0.059539579064467385`",
       "0.6553203983003751`", "1.0073351925495824`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9072521788640547`*^9, 3.9072526568121047`*^9, {3.907252749073128*^9, 
   3.9072527557896876`*^9}, 3.9072529275363483`*^9, 3.9072530505734034`*^9, 
   3.9072532546109376`*^9, 3.90725384470975*^9, 3.9072538902352867`*^9, 
   3.9072540167102776`*^9, 3.9072540545011396`*^9, 3.9072549316687765`*^9, 
   3.907255173690092*^9, 3.907257262631981*^9},
 CellLabel->
  "Out[671]//MatrixForm=",ExpressionUUID->"f3b4ccd9-d4a1-4688-845e-\
873dfdfdc87d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"B2", "-", "B1"}], ",", "\"\<Frobenius\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9072529860281525`*^9, 3.9072529963539815`*^9}, {
  3.9072572568538733`*^9, 3.907257257057863*^9}},
 CellLabel->
  "In[672]:=",ExpressionUUID->"7c7022b3-83c9-4ce4-a2f5-8b4871f2b253"],

Cell[BoxData["0.17119269323760666`"], "Output",
 CellChangeTimes->{3.907252999135437*^9, 3.90725305058338*^9, 
  3.9072532546229496`*^9, 3.907253844719746*^9, 3.9072538902462764`*^9, 
  3.907254016722272*^9, 3.9072540545131426`*^9, 3.907254931698838*^9, 
  3.907255173701087*^9, 3.907257262664962*^9},
 CellLabel->
  "Out[672]=",ExpressionUUID->"15f89d7a-dfec-4019-b59f-2606e67d41c5"]
}, Open  ]]
},
WindowSize->{629.25, 624.75},
WindowMargins->{{Automatic, 40.5}, {Automatic, 54.75}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"accdd652-8ce4-4d51-897e-f352d3994d29"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1334, 31, 86, "Input",ExpressionUUID->"b051db69-d9b6-44f7-9c3e-d1fdd77e9b4a"],
Cell[CellGroupData[{
Cell[1917, 55, 212, 4, 28, "Input",ExpressionUUID->"92a7cb09-91af-4e91-b907-add0498edda2"],
Cell[2132, 61, 1344, 31, 165, "Output",ExpressionUUID->"ef5c77d6-6450-4649-b713-22e514c4749d"]
}, Open  ]],
Cell[3491, 95, 957, 26, 67, "Input",ExpressionUUID->"d0d15832-23d8-4473-8e00-3bc3cc3b008d"],
Cell[4451, 123, 267, 6, 28, "Input",ExpressionUUID->"d50c79a1-a410-43d9-8f87-73320be13141"],
Cell[CellGroupData[{
Cell[4743, 133, 216, 4, 28, "Input",ExpressionUUID->"cfbe2cca-813e-44d6-851f-fe0b27d64e71"],
Cell[4962, 139, 1762, 34, 62, "Output",ExpressionUUID->"38e6bc96-5357-4bac-95d1-acdee66370ad"]
}, Open  ]],
Cell[6739, 176, 485, 10, 28, "Input",ExpressionUUID->"55bdb737-2fa2-4e4f-b986-c35ca0836a04"],
Cell[CellGroupData[{
Cell[7249, 190, 190, 4, 28, "Input",ExpressionUUID->"9fe16466-afb8-4fab-95d1-fe0acc0a9d4c"],
Cell[7442, 196, 1027, 24, 113, "Output",ExpressionUUID->"914d0048-91b0-46d5-8260-c6a80f04a249"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8506, 225, 806, 14, 48, "Input",ExpressionUUID->"df6c85d5-e358-4567-8d64-53cd2cc7491f"],
Cell[9315, 241, 1488, 30, 62, "Output",ExpressionUUID->"24936c82-aa40-4703-aa5f-af4238623df9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10840, 276, 1995, 44, 86, "Input",ExpressionUUID->"94a86a9e-094d-41ac-9491-bf62517d2d32"],
Cell[12838, 322, 1568, 31, 62, "Output",ExpressionUUID->"a2e46148-e246-45bf-b11b-c751369eed51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14443, 358, 327, 7, 48, "Input",ExpressionUUID->"f8990e76-1cfb-4747-8a20-084dc025ecde"],
Cell[14773, 367, 1613, 37, 62, "Output",ExpressionUUID->"48352ea1-1349-4b49-8d8f-550018eda5cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16423, 409, 296, 6, 28, "Input",ExpressionUUID->"b0f047a3-7226-4eb2-b267-a147d36eb107"],
Cell[16722, 417, 653, 10, 32, "Output",ExpressionUUID->"656cebdd-55dc-4384-bd92-057b47f02525"]
}, Open  ]],
Cell[17390, 430, 895, 22, 48, "Input",ExpressionUUID->"eca50271-2960-4610-8dbc-37773b4d2b28"],
Cell[CellGroupData[{
Cell[18310, 456, 471, 13, 48, "Input",ExpressionUUID->"96c8fed6-9609-46f5-bf3d-218451b7da99"],
Cell[18784, 471, 1178, 26, 62, "Output",ExpressionUUID->"f3b4ccd9-d4a1-4688-845e-873dfdfdc87d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19999, 502, 326, 7, 28, "Input",ExpressionUUID->"7c7022b3-83c9-4ce4-a2f5-8b4871f2b253"],
Cell[20328, 511, 384, 6, 32, "Output",ExpressionUUID->"15f89d7a-dfec-4019-b59f-2606e67d41c5"]
}, Open  ]]
}
]
*)

